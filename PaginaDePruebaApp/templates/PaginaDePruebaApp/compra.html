{% extends "PaginaDePruebaApp/base.html" %}

{% load static %}

{% block content %}
<div class="compra">
    <div id="info-compra">
        <li style="margin-left: 20px;"><b>Origen: </b>{{viaje.ruta.origen}}</li>
        <li style="margin-left: 20px;"><b>Destino: </b>{{viaje.ruta.destino}}</li>
        <li style="margin-left: 20px;"><b>Fecha de partida: </b>{{viaje.fechaSalida}}</li>
        <li style="margin-left: 20px;"><b>Fecha de llegada: </b>{{viaje.fechaLlegada}}</li>
        <li style="margin-left: 20px;"><b>Asientos disponibles: </b>{{viaje.asientosDisponibles}}</li>
        <li style="margin-left: 20px;"><b>Tipo de combi: </b>{{viaje.combi.tipo}}</li>
        <li style="margin-left: 20px;"><b>Precio: $</b>{{viaje.precio}}</li>
    </li>
    </div>
        
    <br>
    <div id="insumos-compra">
        <h3>Insumos para su viaje</h3>
        <form class="compra-insumos" action="" method= "post">
            {% csrf_token %}
            <table>{{formInsumos.as_table}}</table>
            <br>
        </form>
    </div>
    
    <div id="invitados">
        {% if invitados %}
            <h3>Lista de invitados</h3>
            {% for invitado in invitados %}
                <li style="margin-left: 20px;">
                    <b>Nombre: </b>{{invitado.nombre}} &nbsp; <b>Apellido: </b>{{invitado.apellido}} &nbsp; <b>DNI: </b>{{invitado.dni}} &nbsp; 
                    <a href="{% url 'EliminarInvitado' invitado.dni viaje.id %}">Eliminar invitado</a>
                </li>    
            {% endfor %}
        {% endif %}
        &nbsp; &nbsp; <a href="{% url 'RegistroInvitado' viaje.id %}" style="color: black; font-size: medium; ">Para agregar un invitado haga click aqu√≠</a>
    </div>
    <div id=form-compra>
        {% if not persona.esGold %}
        <form class="compra" action="" method= "post">
            {% csrf_token %}
            <table>{{formTarjeta.as_table}}</table>
            <br>
            <button class="btn btn-primary" type="submit">Comprar</button>
            <input class="btn btn-primary" type="button" value="No funciona" onclick="submitForms()" />
        </form>
        {% else %}
            <a href="#">[ ] Utilizar tarjeta</a>
            <br>
            <h4>Numero = {{ persona.tarjeta.nro }}</h4>
            <br>
            <a href="#">[ ] Pagar con otra tarjeta</a>
            <form class="compra" action="" method= "post">
                {% csrf_token %}
                <table>{{formTarjeta.as_table}}</table>
                <br>
                <button class="btn btn-primary" type="submit">Comprar</button>
                <input class="btn btn-primary" type="button" value="No funciona" onclick="submitForms()" />
            </form>
            <button class="btn btn-primary" type="submit">Comprar</button>
        {% endif %}
    </div>

</div>
<script>
    function submitForms(){
      document.forms['formTarjeta'].submit();
      document.forms['formInsumos'].submit();
    }
  </script>
{% endblock %}